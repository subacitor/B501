<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>
    <link rel="stylesheet" href="jquery.calendar.css" />
    <link rel="stylesheet" href="Lich-su/style.css">
    <link rel="stylesheet" href="Dang-Ky-Lich/style.css">

    <title>Đăng Ký Lịch</title>
</head>


<body>
    <div class="wrapper">
        <div class="navigation">
            <div class="logo-name" onclick="location.href='index.html'"><img src="img/logo.png" alt="logo"></div>
            <div class="text-name-dangkylich">
                Đăng kí lịch
            </div>
        </div>
        <div class="main-content">
            <div class="side-bar">
                <div style="flex: 99%;">
                    <div class="information-user">
                        <div class="edit-icon" style="float: right;"><i class="fa-solid fa-pen-to-square"></i></div>
                        <div class="logo-user-picture" style="text-align: center;">
                            <img src="https://www.pavilionweb.com/wp-content/uploads/2017/03/man-300x300.png" alt="">
                        </div>
                        <div class="name-user txt-center" id=""></div>
                        <div class="MSSV txt-center" id=""></div>
                    </div>
                    <hr class="line">
                    <div class="application">
                        <div class="book-lich" onclick="location.href='index.html'"><i
                                class="fa-solid fa-calendar-check"></i>Đăng kí lịch mới</div>
                        <div class="history-lich" onclick="location.href='lich-su.html'"><i
                                class="fa-solid fa-clock-rotate-left"></i>Lịch sử đăng kí</div>
                    </div>
                </div>
                <hr class="line">
                <div class="sign-out" style="flex: 1%;">

                    <i class="fa-solid fa-arrow-right-from-bracket"></i><span>Đăng xuất</span>
                </div>
            </div>

            <div class="show-case">
                <div>
                    <div>
                        <div class="test-table" id="test-table">
                            <table class="table" id="tblAct">
                                <thead>
                                    <tr>
                                        <th><span>Ngày mượn</span></th>
                                        <th><span>Tên</span></th>
                                        <th><span>Thời gian</span></th>
                                        <th><span>Thành viên</span></th>
                                        <th><span>Lý do</span></th>
                                        <th><span>Trạng thái</span></th>
                                    </tr>
                                </thead>
                                <tbody id="tblAct">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>


        </div>
        <div class="order-lich">
            <div class="modal">
                <div style="position: absolute; right: 0; padding: 20px;"><i class="fa-solid fa-circle-xmark"
                        id="close-modal" style="cursor: pointer;"></i></div>
                <div style="display: flex; justify-content: center; align-items: center;">
                    <div class="" style="text-align: center; padding: 20px; font-size: 1.5em; font-weight: 500; font-family: 'Anek Latin', sans-serif;
                    ">Thông tin
                        người mượn</div>
                </div>


                <div class="day-just-click" style="padding: 0px 30px; color:rgb(162, 137, 244);">
                    <p style="text-align: left;"><b><span id="lblEventCalendar">[date]</span></b></p>
                </div>

                <form>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Ngày Mượn</span>
                        <input type="text" placeholder="Ngày mượn: " id="NgayMuon">
                    </div>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Họ và tên</span>
                        <input type="text" placeholder="Nhập rõ họ tên" id="username">
                    </div>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Thời gian mượn</span>
                        <div>
                            <select name="Thời gian" id="Time">
                                <option value="Ca sáng (7h30 - 11h30)">Ca sáng (7h30 - 11h30)</option>
                                <option value="Ca chiều (1h30 - 4h30)">Ca chiều (1h30 - 4h30)</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Số lượng thành
                            viên</span>
                        <input type="text" placeholder="Nhập số lượng" id="SoLuong">
                    </div>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Lý do mượn phòng</span>
                        <!-- <input type="text" placeholder="Chi tiết lý do mượn phòng" id="LyDo" style="height: 150px"> -->
                        <textarea name="" id="LyDo" cols="44" rows="10"
                            placeholder="Chi tiết lý do mượn phòng"></textarea>
                    </div>
                </form>
                <div class="btn-xac-nhan-wrapper">
                    <button class="btn-xac-nhan">Xác nhận</button>
                </div>
            </div>
        </div>
        <div class="modal_edit_in4" id="modal-edit-user">
            <div class="modal_edit_in4_content">
                <form>
                    <span id="UID"></span>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Họ và tên</span>
                        <input type="text" placeholder="" id="username_edit" readonly>
                    </div>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Mã số sinh viên</span>
                        <input type="text" placeholder="" id="mssv_edit" readonly>
                    </div>
                    <div class="input-control">
                        <span style="font-weight: 500; font-family: 'Anek Latin', sans-serif;">Email</span>
                        <input type="text" placeholder="" id="email_edit">
                    </div>
                </form>
                <div style="display: flex; justify-content: center;">
                    <div class="btn-xac-in4-user-wrapper">
                        <button class="btn-xac-in4-user">Xác nhận</button>
                    </div>
                    <div class="btn-huy-in4-user-wrapper">
                        <button class="btn-huy-in4-user">Hủy</button>
                    </div>
                </div>
            </div>

        </div>

    </div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="jquery.calendar.js"></script>
<script src="Dang-Ky-Lich/calen.js"></script>

<script>
    $(function () {
        $('#pnlEventCalendar').calendar({
            months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            days: ['Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7', 'Chủ nhật'], onSelect: function (event) {
                $('#lblEventCalendar').text(event.label);
            }
        });
    });
</script>
<script>
    var modal = document.querySelector(".modal_edit_in4");
    window.onclick = function (event) {
        if (event.target == modal) {
            $(".modal_edit_in4").hide();
        }
    }

</script>

<script type="text/javascript">

    function setCookie(cname, cvalue, exdays) {
        const d = new Date();
        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
        let expires = "expires=" + d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }
    //config firebase
    const firebaseConfig = {
        apiKey: "AIzaSyDD7Y5eelmdHmAW8xEwEcmMAFdZGVDzbSE",
        authDomain: "thuongmaidientu-1211f.firebaseapp.com",
        databaseURL: "https://thuongmaidientu-1211f-default-rtdb.firebaseio.com",
        projectId: "thuongmaidientu-1211f",
        storageBucket: "thuongmaidientu-1211f.appspot.com",
        messagingSenderId: "1008396240937",
        appId: "1:1008396240937:web:c4f4819834bfbac3e37438",
        measurementId: "G-LJM6J3R796"
    };

    const defaultApp = firebase.initializeApp(firebaseConfig);
    const auth = defaultApp.auth();
    const provider = new firebase.auth.GoogleAuthProvider();
    console.log(provider);
    // FirebaseUI config.

    var uiConfig = {
        signInSuccessUrl: '../index.html',
        signInOptions: [
            // Leave the lines as is for the providers you want to offer your users.
            firebase.auth.GoogleAuthProvider.PROVIDER_ID,
            // firebase.auth.FacebookAuthProvider.PROVIDER_ID,
            // firebase.auth.TwitterAuthProvider.PROVIDER_ID,
            // firebase.auth.GithubAuthProvider.PROVIDER_ID,
            firebase.auth.EmailAuthProvider.PROVIDER_ID,
            // firebase.auth.PhoneAuthProvider.PROVIDER_ID,
            // firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID
        ],
        // tosUrl and privacyPolicyUrl accept either url string or a callback
        // function.
        // Terms of service url/callback.
        tosUrl: '<Sigin.html>',
        // Privacy policy url/callback.
        privacyPolicyUrl: function () {
            window.location.assign('Sigin.html');
        }
    };

    // Initialize the FirebaseUI Widget using Firebase.
    var ui = new firebaseui.auth.AuthUI(firebase.auth());
    // The start method will wait until the DOM is loaded.
    ui.start('#firebaseui-auth-container', uiConfig);

    firebase.auth().onAuthStateChanged(function (user) {
        setCookie("uid", user.uid);
        setCookie("displayName", user.displayName);

        $("#displayName_user").text(user.displayName);
        $("#username").val(user.displayName);
        $("#username_edit").val(user.displayName);
        $("#email_edit").val(user.email);

        $(".name-user").text(user.displayName);

        console.log(user.uid);
        console.log(user);
        console.log(user.displayName);


        var dataCreateUser = {};
        dataCreateUser.uid = user.uid;
        dataCreateUser.displayName = user.displayName;
        dataCreateUser.email = user.email;
        dataCreateUser.photoURL = user.photoURL;
        dataCreateUser.phoneNumber = user.phoneNumber;

        $.ajax({
            url: "http://103.121.91.135:8080/api/user/createUser?uid=" + user.uid,
            type: "POST",
            dataType: "json",
            data: dataCreateUser,
            success: function (dataCreateUser) {
                console.log("success!");
                console.log(dataCreateUser);
            }
        })
    })
</script>
<script>
    
</script>

</html>